/*
, v0.3.1
by Riki Fridrich <riki@fczbkk.com> (http://fczbkk.com)
https://github.com/fczbkk/UrlMatch
*/
(function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},d=function(a,b){function c(){this.constructor=a}for(var d in b)e.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},e={}.hasOwnProperty;a=function(){function a(a){null==a&&(a=[]),this.patterns=[],this.add(a)}return a.prototype.add=function(a){var b,d,e;for(null==a&&(a=[]),"string"==typeof a&&(a=[a]),b=0,d=a.length;d>b;b++)e=a[b],c.call(this.patterns,e)<0&&this.patterns.push(e);return this.patterns},a.prototype.remove=function(a){return null==a&&(a=[]),"string"==typeof a&&(a=[a]),this.patterns=this.patterns.filter(function(b){return c.call(a,b)<0})},a.prototype.test=function(b){var c,d,e,f,g;for(g=this.patterns,c=0,d=g.length;d>c;c++)if(e=g[c],f=new a.Pattern(e),f.test(b))return!0;return!1},a.Pattern=function(){function b(a){var b;("*"===a||"<all_urls>"===a)&&(a="*://*/*?*#*"),this.original_pattern=a,b=this.sanitize(a),this.pattern=b,this.url_parts=this.getUrlParts(b)}return b.prototype.split_re=/^([a-z]+|\*)*:\/\/(.+@)*([\w\*\.\-]+)*(\:\d+)*(\/([^\?\#]*))*(\?([^\#]*))*(\#(.*))*/,b.prototype.split=function(a,b){var c,d,e,f,g;null==a&&(a=""),null==b&&(b=null),d=a.match(this.split_re),e={scheme:1,host:3,path:6,params:8,fragment:10},f={};for(c in e)g=e[c],f[c]=(null!=d?d[g]:void 0)||b;return f},b.prototype.getUrlParts=function(b){var c;return null==b&&(b=this.pattern),c=this.split(b),{scheme:new a.Scheme(c.scheme),host:new a.Host(c.host),path:new a.Path(c.path),params:new a.Params(c.params),fragment:new a.Fragment(c.fragment)}},b.prototype.sanitize=function(a){var b;return null==a&&(a=this.original_pattern),b="*://*/*?*#*",("*"===a||"<all_urls>"===a)&&(a=b),a},b.prototype.validate=function(a){var b,c,d;null==a&&(a=this.url_parts),c=!0;for(b in a)d=a[b],d.validate()||(c=!1);return c},b.prototype.test=function(a){var b,c,d,e,f,g;if(null!=a){for(g=this.split(a),f=!0,e=["scheme","host","path","params","fragment"],b=0,c=e.length;c>b;b++)d=e[b],this.url_parts[d].test(g[d])||(f=!1);return f}return!1},b}(),a.UrlPart=function(){function a(a){this.original_pattern=a,this.pattern=this.sanitize(a)}return a.prototype.validate=function(a){return null==a&&(a=this.original_pattern),!1},a.prototype.test=function(a,b){return null==a&&(a=""),null==b&&(b=this.pattern),null!=b?b.test(a):!0},a.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validatePattern?RegExp("^"+a+"$"):null},a}(),a.Scheme=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.validate=function(a){return null==a&&(a=this.original_pattern),null!=a?/^(\*|[a-z]+)$/.test(a):!1},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validate(a)?(a=a.replace("*","https?"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a.Host=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.validate=function(a){var b,c,d,e,f,g,h,i;if(null==a&&(a=this.original_pattern),null!=a){for(i=[/.+/],c=[/\*\*/,/\*[^\.]+/,/.\*/,/^(\.|-)/,/(\.|-)$/,/[^a-z0-9-.\*]/],g=!0,b=0,e=i.length;e>b;b++)h=i[b],h.test(a)||(g=!1);for(d=0,f=c.length;f>d;d++)h=c[d],h.test(a)&&(g=!1);return g}return!1},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validate(a)?(a=a.replace(".","\\."),a=a.replace("*","[a-z0-9-.]+"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a.Path=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.validate=function(a){return null==a&&(a=this.original_pattern),!0},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),null==a&&(a=""),a=a.replace(/\/$/,"\\/?"),a=a.replace(/\/\*$/,"((/?)|/*)"),a=a.replace(/\*/g,"[a-zA-Z0-9-./]*"),RegExp("^"+a+"$")},b}(a.UrlPart),a.Params=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.validate=function(a){var b,c,d,e,f;if(null==a&&(a=this.original_pattern),null!=a){for(c=[/\=\=/,/\=[^\&]+\=/,/^\=$/],e=!0,b=0,d=c.length;d>b;b++)f=c[b],f.test(a)&&(e=!1);return e}return!0},b.prototype.sanitize=function(a){var b,c,d,e,f,g,h,i;if(null==a&&(a=this.original_pattern),"*"===a&&(a=null),h={},null!=a)for(f=a.split("&"),b=0,d=f.length;d>b;b++)e=f[b],g=e.split("="),c=g[0],i=g[1],c="*"===c?".+":c.replace(/\*/g,".*"),i="*"===i?"=?.*":"="+i.replace(/\*/g,".*"),h[c]=i;return h},b.prototype.test=function(a,b){var c,d,e,f;null==a&&(a=""),null==b&&(b=this.pattern),e=!0;for(c in b)f=b[c],d=RegExp("(^|\\&)"+c+f+"(\\&|$)"),d.test(a)||(e=!1);return e},b}(a.UrlPart),a.Fragment=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return d(b,a),b.prototype.validate=function(a){var b,c,d,e,f;if(null==a&&(a=this.original_pattern),null!=a){for(c=[/\#/],e=!0,b=0,d=c.length;d>b;b++)f=c[b],f.test(a)&&(e=!1);return e}return!0},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validate(a)&&null!=a?(a=a.replace(/\*/g,".*"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a}(),b="object"==typeof exports?exports:this,b.UrlMatch=a}).call(this);