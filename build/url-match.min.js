// URL Match 0.2.0 (https://github.com/fczbkk/UrlMatch)
// by Riki Fridrich <riki@fczbkk.com> (http://fczbkk.com)
(function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},d={}.hasOwnProperty,e=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};a=function(){function a(a){null==a&&(a=[]),this.patterns=[],this.add(a)}return a.prototype.add=function(a){var b,d,e;for(null==a&&(a=[]),"string"==typeof a&&(a=[a]),d=0,e=a.length;e>d;d++)b=a[d],c.call(this.patterns,b)<0&&this.patterns.push(b);return this.patterns},a.prototype.remove=function(a){return null==a&&(a=[]),"string"==typeof a&&(a=[a]),this.patterns=this.patterns.filter(function(b){return c.call(a,b)<0})},a.prototype.test=function(b){var c,d,e,f,g;for(g=this.patterns,e=0,f=g.length;f>e;e++)if(c=g[e],d=new a.Pattern(c),d.test(b))return!0;return!1},a.Pattern=function(){function b(a){var b;("*"===a||"<all_urls>"===a)&&(a="*://*/*?*#*"),this.original_pattern=a,b=this.sanitize(a),this.pattern=b,this.url_parts=this.getUrlParts(b)}return b.prototype.split_re=/^([a-z]+|\*)*:\/\/(.+@)*([\w\*\.\-]+(\:\d+)*)*(\/([^\?\#]*))*(\?([^\#]*))*(\#(.*))*/,b.prototype.split=function(a,b){var c,d,e,f,g;null==a&&(a=""),null==b&&(b=null),d=a.match(this.split_re),e={scheme:1,host:3,path:6,params:8,fragment:10},f={};for(c in e)g=e[c],f[c]=(null!=d?d[g]:void 0)||b;return f},b.prototype.getUrlParts=function(b){var c;return null==b&&(b=this.pattern),c=this.split(b),{scheme:new a.Scheme(c.scheme),host:new a.Host(c.host),path:new a.Path(c.path),params:new a.Params(c.params),fragment:new a.Fragment(c.fragment)}},b.prototype.sanitize=function(a){var b;return null==a&&(a=this.original_pattern),b="*://*/*?*#*",("*"===a||"<all_urls>"===a)&&(a=b),a},b.prototype.validate=function(a){var b,c,d;null==a&&(a=this.url_parts),c=!0;for(b in a)d=a[b],d.validate()||(c=!1);return c},b.prototype.test=function(a){var b,c,d,e,f,g;if(null!=a){for(d=this.split(a),c=!0,g=["scheme","host","path","params","fragment"],e=0,f=g.length;f>e;e++)b=g[e],this.url_parts[b].test(d[b])||(c=!1);return c}return!1},b}(),a.UrlPart=function(){function a(a){this.original_pattern=a,this.pattern=this.sanitize(a)}return a.prototype.validate=function(a){return null==a&&(a=this.original_pattern),!1},a.prototype.test=function(a,b){return null==a&&(a=""),null==b&&(b=this.pattern),null!=b?b.test(a):!0},a.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validatePattern?RegExp("^"+a+"$"):null},a}(),a.Scheme=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.validate=function(a){return null==a&&(a=this.original_pattern),null!=a?/^(\*|[a-z]+)$/.test(a):!1},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validate(a)?(a=a.replace("*","https?"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a.Host=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.validate=function(a){var b,c,d,e,f,g,h,i;if(null==a&&(a=this.original_pattern),null!=a){for(e=[/.+/],b=[/\*\*/,/\*[^\.]+/,/.\*/,/^(\.|-)/,/(\.|-)$/,/[^a-z0-9-.\*]/],c=!0,f=0,h=e.length;h>f;f++)d=e[f],d.test(a)||(c=!1);for(g=0,i=b.length;i>g;g++)d=b[g],d.test(a)&&(c=!1);return c}return!1},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validate(a)?(a=a.replace(".","\\."),a=a.replace("*","[a-z0-9-.]+"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a.Path=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.validate=function(a){return null==a&&(a=this.original_pattern),!0},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),null!=a?(a=a.replace(/\/$/,"\\/*"),a=a.replace("*","[a-z0-9-./]*"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a.Params=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.validate=function(a){var b,c,d,e,f;if(null==a&&(a=this.original_pattern),null!=a){for(b=[/\=\=/,/\=[^\&]+\=/,/^\=$/],c=!0,e=0,f=b.length;f>e;e++)d=b[e],d.test(a)&&(c=!1);return c}return!0},b.prototype.sanitize=function(a){var b,c,d,e,f,g,h,i;if(null==a&&(a=this.original_pattern),"*"===a&&(a=null),d={},null!=a)for(h=a.split("&"),f=0,g=h.length;g>f;f++)c=h[f],i=c.split("="),b=i[0],e=i[1],b="*"===b?".+":b.replace(/\*/g,".*"),e="*"===e?"=?.*":"="+e.replace(/\*/g,".*"),d[b]=e;return d},b.prototype.test=function(a,b){var c,d,e,f;null==a&&(a=""),null==b&&(b=this.pattern),e=!0;for(c in b)f=b[c],d=RegExp("(^|\\&)"+c+f+"(\\&|$)"),d.test(a)||(e=!1);return e},b}(a.UrlPart),a.Fragment=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return e(b,a),b.prototype.validate=function(a){var b,c,d,e,f;if(null==a&&(a=this.original_pattern),null!=a){for(b=[/\#/],c=!0,e=0,f=b.length;f>e;e++)d=b[e],d.test(a)&&(c=!1);return c}return!0},b.prototype.sanitize=function(a){return null==a&&(a=this.original_pattern),this.validate(a)&&null!=a?(a=a.replace(/\*/g,".*"),RegExp("^"+a+"$")):null},b}(a.UrlPart),a}(),b="object"==typeof exports?exports:this,b.UrlMatch=a}).call(this);